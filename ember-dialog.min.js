(function(){"use strict";var e=Ember;var t=function(){var e=Ember.$;var t=Math.max.apply(null,e.map(e(":visible:not(.highest)"),function(t){if(e(t).css("position")==="absolute"||e(t).css("position")==="relative"){return e(t).css("z-index")>>0||1}return 0}));return t};var a=Ember.computed;var r=Ember.observer;var i;i=Ember.Component.extend({layoutName:"dialog",isVisible:false,fixedZIndex:false,isActive:a("name","dialogManager.active",function(){return this.get("name")===this.get("dialogManager.active")}),_visibleDidChange:r("isVisible",function(){if(!this.get("isVisible")){return}Ember.run.scheduleOnce("afterRender",this,function(){var e,a;if(!this.get("fixedZIndex")){a=t();e=this.$(".dialog-dialog");e.css({"z-index":a+1})}this.focus()})}),show:function(){return this.set("isVisible",true)},hide:function(){this.set("isVisible",false)},close:function(){return this.get("dialogManager").close(this.get("name"))},decline:function(){Ember.ENV.LOG_DIALOG&&Ember.Logger.log("✘ %cDecline action%c: "+this.get("name"),"font-weight: 900; color: #900;",null);if(this.has("rejected")){this.get("rejected").call(this,this)}this.close();return this},accept:function(){Ember.ENV.LOG_DIALOG&&Ember.Logger.log("✓ %cConfirm action%c "+this.get("name"),"font-weight: 900; color: #070;",null);if(this.has("resolved")){this.get("resolved").call(this,this)}this.close();return this},keyDown:function(e){var t;if(this.get("isActive")){t=this.get("childViews")[0].get("controller");if(e.keyCode===27){t.send(this.get("declineHandlerName"),this);return false}if(e.keyCode===13){t.send(this.get("acceptHandlerName"),this);return false}}},click:function(e){if(Ember.$(e.target).hasClass("substrate")){this.close()}},focus:function(){var e=this.$().find("input:visible:first, button:visible:not(.close):first").first();if(e.size()){e.focus()}else{this.$(".dialog-content").focus()}},actions:{decline:function(e){this.decline()},accept:function(e){this.accept()}}});var n=i;var l=Ember.Namespace.create({VERSION:"2.0.0"});if(Ember.libraries){Ember.libraries.registerCoreLibrary("Ember Dialog",l.VERSION)}var s=l;var o;var c=Ember.Service;if(!c){c=Ember.Object}o=c.extend(Ember.Evented,{rootElement:"body",defaults:{ms:5e3,decline:"decline",accept:"accept"},dialogData:{acceptLabel:"yes",declineLabel:"no",acceptClass:"btn-primary",declineClass:"btn-default",acceptHandlerName:"accept",declineHandlerName:"decline",substrate:false,title:"",className:""},active:Ember.computed.alias("dialogsList.lastObject"),dialogsList:Ember.makeArray(),_dialogs:Ember.Object.create(),destroy:function(){Ember.ENV.LOG_DIALOG&&Ember.Logger.log("%cDialogManager:%c Destroying!","font-weight: 900;",null);var e=this.get("dialogsList"),t,a;for(var r in e){if(!e.hasOwnProperty(r)){continue}if(Ember.isBlank(e[r])){continue}t=e[r];a=this.get("_dialogs").get(t);this._destroyDialog(t)}return this._super.apply(this,arguments)},reset:function(){this.dialogsList=[];this._dialogs=Ember.Object.create();return this._super.apply(this,arguments)},alert:function(e,t,a){a=Ember.typeOf(a)==="object"?a:{};var r=a.className||"";a=Ember.$.extend({},this.get("dialogData"),a,{className:["alert",r].join(" ")});return this._openWithLayout("dialogs/alert",e,t,a)},confirm:function(e,t,a){a=Ember.typeOf(a)==="object"?a:{};var r=a.className||"";a=Ember.$.extend({},this.get("dialogData"),a,{className:["confirm",r].join(" ")});return this._openWithLayout("dialogs/confirm",e,t,a)},custom:function(e,t,a){a=Ember.typeOf(a)==="object"?a:{};var r=a.className||"";a=Ember.$.extend({},this.get("dialogData"),a,{className:["custom",r].join(" ")});return this._openWithLayout("dialogs/custom",e,t,a)},notice:function(e,t,a){a=Ember.typeOf(a)==="object"?a:{};var r=a.name||this._generateDialogName();var i=a.className||"";a=Ember.$.extend({name:r},this.get("dialogData"),a,{className:["notice","highest",i].join(" "),substrate:false});var n=this._openWithLayout("dialogs/notice",e,null,a,false),l=this.getDialog(r);l.reopen({click:function(){this.accept()}});if(Ember.typeOf(t)!=="null"&&t!==Infinity){t=t>>0||this.get("defaults.ms");return new Ember.RSVP.Promise(function(e,a){setTimeout(l.accept.bind(l),t);n.then(e,a)}.bind(this))}else{return n}},open:function(e,t,a,r,i){var n=a.container||this.container,l=this.getDialog(e),s=a.namespace&&a.namespace.rootElement||this.get("rootElement"),o={name:e};Ember.merge(o,r||{});Ember.ENV.LOG_DIALOG&&Ember.Logger.log("%cDialogManager:%c Opening dialog named %s","font-weight: 900;",null,e);if(Ember.typeOf(l)==="undefined"){Ember.ENV.LOG_DIALOG&&Ember.Logger.log("%cDialogManager:%c Creating dialog named %s","font-weight: 900;",null,e);l=n.lookupFactory("dialog:presenter").createWithMixins(o);if(!Ember.isEqual(o.declineHandlerName,this.get("defaults.decline"))||!Ember.isEqual(o.acceptHandlerName,this.get("defaults.accept"))){var c={};if(!Ember.isEqual(o.declineHandlerName,this.get("defaults.decline"))){c[o.declineHandlerName]=function(e){this.decline()}}if(!Ember.isEqual(o.acceptHandlerName,this.get("defaults.accept"))){c[o.acceptHandlerName]=function(e){this.accept()}}l.reopen({actions:c})}this.setDialog(e,l);if(Ember.typeOf(t)==="string"){t=this._getView(t,a);l.set("body",t)}else if(Ember.typeOf(t)==="class"){l.setProperties({body:t})}else{throw new Ember.Error("The given view unrecognized")}Ember.run(function(){l.appendTo(s)})}i&&this.get("dialogsList").pushObject(e);return l.show()},close:function(e){this.get("controllers:"+e).reopen({target:this.get("targets:"+e)});return new Ember.RSVP.Promise(Ember.run.bind(this,function(t,a){var r=this.get("dialogsList");this.set("dialogsList",r.without(e));var i=this.getDialog(e);Ember.ENV.LOG_DIALOG&&Ember.Logger.log("%cDialogManager:%c Closing the dialog named %s","font-weight: 900;",null,e);this._destroyDialog(e);t(i);if(this.get("active")){var n=this.getDialog(this.get("active"));n&&n.focus()}}))},closeAll:function(){var e=this.get("dialogsList");for(var t in e){if(!e.hasOwnProperty(t)){continue}if(Ember.isBlank(e[t])){continue}this.close(e[t])}},getDialog:function(e){return this.get("_dialogs").get(e)},setDialog:function(e,t){Ember.ENV.LOG_DIALOG&&Ember.Logger.log("%cDialogManager:%c Register dialog named %s","font-weight: 900;",null,e);return this.get("_dialogs").set(e,t)},_generateDialogName:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,a=e=="x"?t:t&3|8;return a.toString(16)})},_destroyDialog:function(e){var t=Ember.typeOf(e)==="string"?this.getDialog(e):e;if(!t){Ember.ENV.LOG_DIALOG&&Ember.Logger.warn("%cDialogManager:%c The dialog named %s not found","font-weight: 900;",null,e);return this}e=t.get("name");Ember.ENV.LOG_DIALOG&&Ember.Logger.log("%cDialogManager:%c Destroying %s","font-weight: 900;",null,t.get("name"));t.destroy();var a=this.get("_dialogs");delete a[e];var r=this.get("dialogsList");this.set("dialogsList",r.without(e));return this},_getView:function(e,t){var a="",r=t.container||this.container;if(Ember.typeOf(e)==="string"){a=r.lookup("template:"+e);try{a=a||Ember.Handlebars.compile(e)}catch(i){Ember.Logger.error("You have to include `ember-template-compiler.js` file to compile templates on fly")}e=Ember.View.extend({template:a,controller:t})}else if(Ember.typeOf(e)==="class"){e=Ember.copy(e);e=Ember.View.extend({controller:t})}else{throw new Ember.Error("The given view unrecognized. Should be a text or name of template or view class.")}return e},_openWithLayout:function(e,t,a,r,i){var n,l,s=Ember.typeOf(r.name)==="string"?r.name:this._generateDialogName();if(!(a instanceof Ember.Controller)&&Ember.typeOf(a)==="object"){a=Ember.Controller.create(a)}else{a=a||Ember.Controller.create()}t=this._getView(t,a);r=r||{};i=Ember.typeOf(i)==="undefined"?true:i;t.reopen({layoutName:e});n=this.open(s,t,a,r,i);this.set("controllers:"+s,a);this.set("targets:"+s,a.target);a.reopen({target:n,dialog:Ember.computed.alias("target").readOnly()});l=new Ember.RSVP.Promise(function(e,t){n.reopen({resolved:e,rejected:t})});return l}}).reopenClass({toString:function(){return"(subclass of Dialog.Manager)"}});var d=o;function h(e){e.register("dialog:manager",o,{singleton:true});e.injection("controller","dialogManager","dialog:manager");e.injection("dialog:presenter","dialogManager","dialog:manager")}var m=h;function g(e){e.register("dialog:presenter",i)}var u=g;function p(e,t){m(e,t);u(e,t)}var b=p;Ember.onLoad("Ember.Application",function(e){e.initializer({name:"ember-dialog",initialize:b})});s.Manager=o;s.Presenter=i;s._setupContainer=b;Ember.lookup.Dialog=s;var v=s;Ember.TEMPLATES["dialog"]=Ember.HTMLBars.template(function(){return{isHTMLBars:true,revision:"Ember@1.11.1",blockParams:0,cachedFragment:null,hasRendered:false,build:function e(t){var a=t.createDocumentFragment();var r=t.createElement("div");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("div");t.setAttribute(i,"class","dialog-content");t.setAttribute(i,"tabindex","-1");var n=t.createTextNode("\n        ");t.appendChild(i,n);var n=t.createComment("");t.appendChild(i,n);var n=t.createTextNode("\n    ");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);var r=t.createTextNode("\n");t.appendChild(a,r);return a},render:function t(e,a,r){var i=a.dom;var n=a.hooks,l=n.element,s=n.get,o=n.inline;i.detectNamespace(r);var c;if(a.useFragmentCache&&i.canClone){if(this.cachedFragment===null){c=this.build(i);if(this.hasRendered){this.cachedFragment=c}else{this.hasRendered=true}}if(this.cachedFragment){c=i.cloneNode(this.cachedFragment,true)}}else{c=this.build(i)}var d=i.childAt(c,[0]);var h=i.createMorphAt(i.childAt(d,[1]),1,1);l(a,d,e,"bind-attr",[],{"class":":dialog-dialog :component-dialog-dialog className substrate"});o(a,h,e,"view",[s(a,e,"body")],{dialog:s(a,e,"controller")});return c}}}());Ember.TEMPLATES["dialogs/alert"]=Ember.HTMLBars.template(function(){return{isHTMLBars:true,revision:"Ember@1.11.1",blockParams:0,cachedFragment:null,hasRendered:false,build:function e(t){var a=t.createDocumentFragment();var r=t.createElement("div");t.setAttribute(r,"class","dialog-header");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("button");t.setAttribute(i,"type","button");t.setAttribute(i,"class","close");var n=t.createTextNode("×");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("div");t.setAttribute(i,"class","dialog-title");var n=t.createComment("");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);var r=t.createTextNode("\n");t.appendChild(a,r);var r=t.createElement("div");t.setAttribute(r,"class","dialog-body");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createComment("");t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);var r=t.createTextNode("\n");t.appendChild(a,r);var r=t.createElement("div");t.setAttribute(r,"class","dialog-footer");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("button");t.setAttribute(i,"type","button");var n=t.createComment("");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);return a},render:function t(e,a,r){var i=a.dom;var n=a.hooks,l=n.get,s=n.element,o=n.content;i.detectNamespace(r);var c;if(a.useFragmentCache&&i.canClone){if(this.cachedFragment===null){c=this.build(i);if(this.hasRendered){this.cachedFragment=c}else{this.hasRendered=true}}if(this.cachedFragment){c=i.cloneNode(this.cachedFragment,true)}}else{c=this.build(i)}var d=i.childAt(c,[0]);var h=i.childAt(d,[1]);var m=i.childAt(c,[4,1]);var g=i.createMorphAt(i.childAt(d,[3]),0,0);var u=i.createMorphAt(i.childAt(c,[2]),1,1);var p=i.createMorphAt(m,0,0);s(a,h,e,"action",[l(a,e,"view.dialog.acceptHandlerName"),l(a,e,"view.dialog")],{});o(a,g,e,"view.dialog.title");o(a,u,e,"yield");s(a,m,e,"bind-attr",[],{"class":":btn view.dialog.acceptClass"});s(a,m,e,"action",[l(a,e,"view.dialog.acceptHandlerName"),l(a,e,"view.dialog")],{});o(a,p,e,"view.dialog.acceptLabel");return c}}}());Ember.TEMPLATES["dialogs/confirm"]=Ember.HTMLBars.template(function(){return{isHTMLBars:true,revision:"Ember@1.11.1",blockParams:0,cachedFragment:null,hasRendered:false,build:function e(t){var a=t.createDocumentFragment();var r=t.createElement("div");t.setAttribute(r,"class","dialog-header");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("button");t.setAttribute(i,"type","button");t.setAttribute(i,"class","close");var n=t.createTextNode("×");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("div");t.setAttribute(i,"class","dialog-title");var n=t.createComment("");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);var r=t.createTextNode("\n");t.appendChild(a,r);var r=t.createElement("div");t.setAttribute(r,"class","dialog-body");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createComment("");t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);var r=t.createTextNode("\n");t.appendChild(a,r);var r=t.createElement("div");t.setAttribute(r,"class","dialog-footer");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("button");t.setAttribute(i,"type","button");var n=t.createComment("");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createElement("button");t.setAttribute(i,"type","button");var n=t.createComment("");t.appendChild(i,n);t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);return a},render:function t(e,a,r){var i=a.dom;var n=a.hooks,l=n.get,s=n.element,o=n.content;i.detectNamespace(r);var c;if(a.useFragmentCache&&i.canClone){if(this.cachedFragment===null){c=this.build(i);if(this.hasRendered){this.cachedFragment=c}else{this.hasRendered=true}}if(this.cachedFragment){c=i.cloneNode(this.cachedFragment,true)}}else{c=this.build(i)}var d=i.childAt(c,[0]);var h=i.childAt(d,[1]);var m=i.childAt(c,[4]);var g=i.childAt(m,[1]);var u=i.childAt(m,[3]);var p=i.createMorphAt(i.childAt(d,[3]),0,0);var b=i.createMorphAt(i.childAt(c,[2]),1,1);var v=i.createMorphAt(g,0,0);var f=i.createMorphAt(u,0,0);s(a,h,e,"action",[l(a,e,"view.dialog.declineHandlerName"),l(a,e,"view.dialog")],{});o(a,p,e,"view.dialog.title");o(a,b,e,"yield");s(a,g,e,"bind-attr",[],{"class":":btn view.dialog.acceptClass"});s(a,g,e,"action",[l(a,e,"view.dialog.acceptHandlerName"),l(a,e,"view.dialog")],{});o(a,v,e,"view.dialog.acceptLabel");s(a,u,e,"bind-attr",[],{"class":":btn view.dialog.declineClass"});s(a,u,e,"action",[l(a,e,"view.dialog.declineHandlerName"),l(a,e,"view.dialog")],{});o(a,f,e,"view.dialog.declineLabel");return c}}}());Ember.TEMPLATES["dialogs/custom"]=Ember.HTMLBars.template(function(){return{isHTMLBars:true,revision:"Ember@1.11.1",blockParams:0,cachedFragment:null,hasRendered:false,build:function e(t){var a=t.createDocumentFragment();var r=t.createComment("");t.appendChild(a,r);return a},render:function t(e,a,r){var i=a.dom;var n=a.hooks,l=n.content;i.detectNamespace(r);var s;if(a.useFragmentCache&&i.canClone){if(this.cachedFragment===null){s=this.build(i);if(this.hasRendered){this.cachedFragment=s}else{this.hasRendered=true}}if(this.cachedFragment){s=i.cloneNode(this.cachedFragment,true)}}else{s=this.build(i)}var o=i.createMorphAt(s,0,0,r);i.insertBoundary(s,null);i.insertBoundary(s,0);l(a,o,e,"yield");return s}}}());Ember.TEMPLATES["dialogs/notice"]=Ember.HTMLBars.template(function(){return{isHTMLBars:true,revision:"Ember@1.11.1",blockParams:0,cachedFragment:null,hasRendered:false,build:function e(t){var a=t.createDocumentFragment();var r=t.createElement("div");t.setAttribute(r,"class","dialog-body");var i=t.createTextNode("\n    ");t.appendChild(r,i);var i=t.createComment("");t.appendChild(r,i);var i=t.createTextNode("\n");t.appendChild(r,i);t.appendChild(a,r);return a},render:function t(e,a,r){var i=a.dom;var n=a.hooks,l=n.content;i.detectNamespace(r);var s;if(a.useFragmentCache&&i.canClone){if(this.cachedFragment===null){s=this.build(i);if(this.hasRendered){this.cachedFragment=s}else{this.hasRendered=true}}if(this.cachedFragment){s=i.cloneNode(this.cachedFragment,true)}}else{s=this.build(i)}var o=i.createMorphAt(i.childAt(s,[0]),1,1);l(a,o,e,"yield");return s}}}())}).call(this);